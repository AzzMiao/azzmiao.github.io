"use strict";(self["webpackChunkpets_vue"]=self["webpackChunkpets_vue"]||[]).push([[200],{4200:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var s=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("div",[t("h3",[e._v("发布领养信息")])])]),t("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{staticClass:"topMargin",attrs:{label:"标题：",prop:"title"}},[t("el-row",[t("el-col",[t("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1)],1),t("el-form-item",{staticClass:"topMargin",attrs:{label:"宠物类型：",prop:"petType"}},[t("el-select",{attrs:{placeholder:"宠物类型"},model:{value:e.form.petType,callback:function(t){e.$set(e.form,"petType",t)},expression:"form.petType"}},e._l(e.typeOptions,(function(e){return t("el-option",{key:e.value,staticStyle:{"line-height":"38px",height:"38px"},attrs:{label:e.label,value:e.value}})})),1)],1),e.isEdit?e._e():t("el-form-item",{staticClass:"topMargin",attrs:{label:"预设模板："}},[[t("el-select",{attrs:{placeholder:"预设模板"},on:{change:function(t){return e.aboutTemplateChange()}},model:{value:e.aboutTemplate,callback:function(t){e.aboutTemplate=t},expression:"aboutTemplate"}},e._l(e.templateOptions,(function(e){return t("el-option",{key:e.value,staticStyle:{"line-height":"38px",height:"38px"},attrs:{label:e.label,value:e.value}})})),1)]],2),t("el-form-item",{staticClass:"topMargin",attrs:{label:"地区："}},[t("el-cascader",{attrs:{size:"large",options:e.options,props:{expandTrigger:"hover"}},on:{change:e.regionChange},model:{value:e.selectedOptions,callback:function(t){e.selectedOptions=t},expression:"selectedOptions"}})],1),t("el-form-item",{staticClass:"topMargin",attrs:{label:"健康信息："}},[t("div",[t("el-switch",{staticStyle:{"margin-left":"14px","margin-bottom":"4px"},attrs:{"active-text":"已驱虫","active-value":"true","inactive-text":"未驱虫","inactive-value":"false"},on:{change:function(t){e.form.isDewormed,e.form.isDewormed}},model:{value:e.form.isDewormed,callback:function(t){e.$set(e.form,"isDewormed",t)},expression:"form.isDewormed"}}),t("el-switch",{staticStyle:{"margin-left":"14px","margin-bottom":"4px"},attrs:{"active-text":"已打疫苗","active-value":"true","inactive-text":"未打疫苗","inactive-value":"false"},on:{change:function(t){e.form.isVaccinated,e.form.isVaccinated}},model:{value:e.form.isVaccinated,callback:function(t){e.$set(e.form,"isVaccinated",t)},expression:"form.isVaccinated"}})],1)]),t("el-form-item",[t("el-switch",{staticStyle:{"margin-left":"14px","margin-bottom":"4px"},attrs:{"active-text":"已绝育","active-value":"true","inactive-text":"未绝育","inactive-value":"false"},on:{change:function(t){e.form.isSterilized,e.form.isSterilized}},model:{value:e.form.isSterilized,callback:function(t){e.$set(e.form,"isSterilized",t)},expression:"form.isSterilized"}}),t("el-switch",{staticStyle:{"margin-left":"14px","margin-bottom":"4px"},attrs:{"active-text":"雄性","active-value":"true","inactive-text":"雌性","inactive-value":"false"},on:{change:function(t){e.form.gender,e.form.gender}},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}})],1)],1),t("el-col",{attrs:{span:10}},[t("div",{staticClass:"col-md-4 about-colorbar"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-11 col-md-10",staticStyle:{"margin-top":"30px"},attrs:{id:"rate-wrap"}},[t("h2",{staticClass:"mobmid"},[e._v("宠物属性 ")]),t("div",[t("p",[e._v("kind")]),t("div",{staticClass:"progress",attrs:{slot:"reference"},slot:"reference"},[t("el-rate",{staticClass:"rate-mark-row",attrs:{max:10},model:{value:e.form.rateData.kind,callback:function(t){e.$set(e.form.rateData,"kind",t)},expression:"form.rateData.kind"}}),t("div",{class:"progress-bar progress-bar-1",style:{width:10*e.form.rateData.kind+"%"},attrs:{role:"progressbar","aria-valuenow":"65","aria-valuemin":"0","aria-valuemax":"100"}},[t("span",{staticClass:"sr-only"},[e._v(e._s(10*e.form.rateData.kind)+"% ")])]),e.form.rateData.kind?e._e():t("i",{staticClass:"el-icon-edit mainright",staticStyle:{"line-height":"20px","margin-right":"12px"}}),e.form.rateData.kind?t("i",{staticClass:"el-icon-check mainright",staticStyle:{"line-height":"20px","margin-right":"12px"}}):e._e()],1)]),t("div",[t("p",[e._v("vitality")]),t("div",{staticClass:"progress",attrs:{slot:"reference"},slot:"reference"},[t("el-rate",{staticClass:"rate-mark-row",attrs:{max:10},model:{value:e.form.rateData.vitality,callback:function(t){e.$set(e.form.rateData,"vitality",t)},expression:"form.rateData.vitality"}}),t("div",{class:"progress-bar progress-bar-1",style:{width:10*e.form.rateData.vitality+"%"},attrs:{role:"progressbar","aria-valuenow":"65","aria-valuemin":"0","aria-valuemax":"100"}},[t("span",{staticClass:"sr-only"},[e._v(e._s(10*e.form.rateData.vitality)+"% ")])]),e.form.rateData.vitality?e._e():t("i",{staticClass:"el-icon-edit mainright",staticStyle:{"line-height":"20px","margin-right":"12px"}}),e.form.rateData.vitality?t("i",{staticClass:"el-icon-check mainright",staticStyle:{"line-height":"20px","margin-right":"12px"}}):e._e()],1)]),t("div",[t("p",[e._v("independent")]),t("div",{staticClass:"progress",attrs:{slot:"reference"},slot:"reference"},[t("el-rate",{staticClass:"rate-mark-row",attrs:{max:10},model:{value:e.form.rateData.independent,callback:function(t){e.$set(e.form.rateData,"independent",t)},expression:"form.rateData.independent"}}),t("div",{class:"progress-bar progress-bar-1",style:{width:10*e.form.rateData.independent+"%"},attrs:{role:"progressbar","aria-valuenow":"65","aria-valuemin":"0","aria-valuemax":"100"}},[t("span",{staticClass:"sr-only"},[e._v(e._s(10*e.form.rateData.independent)+"% ")])]),e.form.rateData.independent?e._e():t("i",{staticClass:"el-icon-edit mainright",staticStyle:{"line-height":"20px","margin-right":"12px"}}),e.form.rateData.independent?t("i",{staticClass:"el-icon-check mainright",staticStyle:{"line-height":"20px","margin-right":"12px"}}):e._e()],1)]),t("div",[t("p",[e._v("iq")]),t("div",{staticClass:"progress",attrs:{slot:"reference"},slot:"reference"},[t("el-rate",{staticClass:"rate-mark-row",attrs:{max:10},model:{value:e.form.rateData.iq,callback:function(t){e.$set(e.form.rateData,"iq",t)},expression:"form.rateData.iq"}}),t("div",{class:"progress-bar progress-bar-1",style:{width:10*e.form.rateData.iq+"%"},attrs:{role:"progressbar","aria-valuenow":"65","aria-valuemin":"0","aria-valuemax":"100"}},[t("span",{staticClass:"sr-only"},[e._v(e._s(10*e.form.rateData.iq)+"% ")])]),e.form.rateData.iq?e._e():t("i",{staticClass:"el-icon-edit mainright",staticStyle:{"line-height":"20px","margin-right":"12px"}}),e.form.rateData.iq?t("i",{staticClass:"el-icon-check mainright",staticStyle:{"line-height":"20px","margin-right":"12px"}}):e._e()],1)])])])])])],1),t("el-form-item",{staticClass:"topMargin",attrs:{label:"封面：",prop:"cover"}},[t("el-row",[t("el-col",{attrs:{span:10}},[t("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{action:e.uploadCoverURL,headers:e.headers,"show-file-list":!1,"auto-upload":!0,"before-upload":e.beforeUpload,"on-success":e.handleAvatarSuccess,"on-change":e.handleChange,"on-remove":e.handleRemove}},[e.form.cover?t("el-image",{staticClass:"avatar",staticStyle:{width:"368px"},attrs:{src:e.form.cover,fit:"cover"}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1)],1)],1),t("el-form-item",{staticClass:"topMargin",staticStyle:{width:"800px"},attrs:{label:"描述：",prop:"description"}},[t("el-input",{attrs:{type:"textarea",placeholder:"宠物描述",maxlength:"200",rows:5,"show-word-limit":""},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),t("el-form-item",{staticClass:"topMargin",attrs:{label:"About："}},[t("el-table",{staticStyle:{width:"600px"},attrs:{data:e.form.about}},[t("el-table-column",{attrs:{label:"属性名称",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"about."+a.$index+".name",rules:e.rules.about}},[t("el-input",{model:{value:a.row.name,callback:function(t){e.$set(a.row,"name",t)},expression:"scope.row.name"}})],1)]}}])}),t("el-table-column",{attrs:{label:"属性值",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-form-item",{attrs:{prop:"about."+a.$index+".value",rules:e.rules.about}},[t("el-input",{model:{value:a.row.value,callback:function(t){e.$set(a.row,"value",t)},expression:"scope.row.value"}})],1)]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleDelete(a.$index,a.row)}}},[e._v("删除")])]}}])})],1)],1),t("el-form-item",{staticClass:"topMargin"},[t("el-button",{staticStyle:{"margin-left":"152px"},on:{click:e.addDomain}},[e._v("新增属性")])],1),t("el-form-item",{staticClass:"topMargin",attrs:{label:"Content：",prop:"content"}},[t("el-tiptap",{attrs:{extensions:e.extensions,lang:"zh",placeholder:"请输入宠物详细内容",height:"610"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),t("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[e.isEdit?t("el-form-item",{staticClass:"topMargin"},[t("div",{staticStyle:{"margin-right":"100px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.editArticle}},[e._v("保存修改")]),t("el-button",[e._v("取消")])],1)]):t("el-form-item",{staticClass:"topMargin"},[t("div",{staticStyle:{"margin-right":"100px"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit(!1)}}},[e._v("发布")]),t("el-button",{on:{click:function(t){return e.onSubmit(!0)}}},[e._v("存入草稿")])],1)])],1)],1)],1)},i=[],r=(a(7658),a(3266)),l=a(54),o=a(9343),n=a(9417),c=a(7087),m={name:"AdoptWorkspace",components:{"el-tiptap":r.ue},mounted(){this.headers={accessToken:c.Z.getItem("accessToken")},this.uploadCoverURL=o.AW(),this.initData()},data(){return{uploadCoverURL:"",headers:{},file:null,form:{adoptId:null,title:"",description:"",about:[],content:"",cover:"",petType:"",contentType:"HTML",isDewormed:!1,isVaccinated:!1,isSterilized:!1,gender:!1,region:"",rateData:{kind:0,vitality:0,independent:0,iq:0}},aboutTemplate:"",contentTemplate:"",templateOptions:[{name:"cat",label:"猫咪百科"},{name:"dog",label:"狗狗百科"},{name:"bird",label:"鸟类百科"},{name:"fish",label:"鱼类百科"},{name:"turtle",label:"龟类百科"},{name:"rabbit",label:"兔类百科"}],typeOptions:[{name:"cat",label:"猫咪百科"},{name:"dog",label:"狗狗百科"},{name:"bird",label:"鸟类百科"},{name:"fish",label:"鱼类百科"},{name:"turtle",label:"龟类百科"},{name:"rabbit",label:"兔类百科"}],options:l.eB,selectedOptions:[],isEdit:!1,rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{min:2,max:30,message:"长度在 2 到 30 个字符",trigger:"blur"}],pet_Type:[{required:!0,message:"请选择宠物类型",trigger:"change"}],cover:[{required:!0,message:"请上传封面",trigger:"blur"}],description:[{required:!0,message:"请输入内描述容",trigger:"blur"}],about:[{required:!0,message:"属性值不能为空",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]},extensions:[new r.QW,new r.xv,new r.nv,new r.X6({level:5}),new r.d8({bubble:!0}),new r.v6({bubble:!0,menubar:!1}),new r.Tx,new r.Re,new r.HC,new r.DY,new r.GS,new r.dn,new r.Ee({uploadRequest(e){const t=new FormData;return t.append("file",e),o.bG(t).then((e=>e.result.fileUrl))}}),new r.V6,new r.PH,new r.Ai,new r.iA,new r.xD,new r.pj,new r.SC,new r.bo,new r.d9]}},methods:{initData(){void 0!=this.$route.params.adoptId&&(this.form.adoptId=this.$route.params.adoptId,this.isEdit=!0,n.Zj(this.form.adoptId).then((e=>{e.success?(this.form=e.result,delete this.form.creator,delete this.form.form.rateData,delete this.form.adoptState,delete this.form.createTime,delete this.form.collectionCount,this.form.about=JSON.parse(e.result.about),this.form.adoptId=this.$route.params.adoptId):this.$message.error(e.message)}))),n.tU().then((e=>{e.success?this.typeOptions=JSON.parse(e.result):this.$message.error(e.message)})),n.ML().then((e=>{e.success?this.templateOptions=JSON.parse(e.result):this.$message.error(e.message)}))},regionChange(){this.form.region="";for(let e=0;e<this.selectedOptions.length;e++)this.form.region+=l.Se[this.selectedOptions[e]],e<this.selectedOptions.length-1&&(this.form.region+=",")},aboutTemplateChange(){""!=this.aboutTemplate&&n.e4(this.aboutTemplate).then((e=>{e.success?(this.$message.success("获取模板成功"),this.form.about=JSON.parse(e.result.aboutTemplate),this.form.content=e.result.contentTemplate):this.$message.error(e.message)}))},handleDelete(e,t){this.form.about.splice(e,1)},addDomain(){this.form.about.push({name:"",value:""})},beforeUpload(e){const t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},handleRemove(e,t){this.file=null,console.info(this.file)},handleChange(e,t){console.info(e),this.file=e},handleAvatarSuccess(e,t){console.info(t),this.file=t;window.URL||window.webkitURL;this.form.cover=e.result.fileUrl,this.$message.success("图片上传成功")},onSubmit(e){this.$refs.ruleForm.validate((async e=>{if(!e)return this.$message.error("请完善宠物信息"),!1;n.Bu(this.form).then((e=>{e.success?this.$message.success("宠物领养信息发布成功"):this.$message.error(e.message)}))}))},editArticle(){this.$refs.ruleForm.validate((async e=>{if(!e)return this.$message.error("请完善百科信息"),!1;n.editAdopt(this.form).then((e=>{e.success?this.$message.success("百科保存成功"):this.$message.error(e.message)}))}))},async getChannelsFn(){this.loading=!0,this.loading=!1},async inquireArticleFn(){}},created(){this.getChannelsFn(),this.isEdit&&this.inquireArticleFn()}},p=m,u=a(1001),d=(0,u.Z)(p,s,i,!1,null,null,null),f=d.exports}}]);
//# sourceMappingURL=200.cbfc56bc.js.map